<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Facturador ML Venezuela - Dashboard</title>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <div class="navbar">
        <div class="logo">FacturaML</div>
        <div class="nav-user">
            <div class="user-info" id="userDisplayName">Cargando...</div>
            <button class="logout-btn" id="logoutButton">Cerrar Sesión</button>
        </div>
    </div>

    <div class="container">
        <div class="dashboard-header">
            <div class="dashboard-title">Panel de Control</div>
            <div>
                <button class="btn" id="newInvoiceBtn">Nueva Factura</button>
            </div>
        </div>

        <div class="dashboard-stats">
            <div class="stat-card">
                <div class="stat-number" id="availableInvoices">0</div>
                <div class="stat-label">Facturas Disponibles</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="issuedInvoices">0</div>
                <div class="stat-label">Facturas Emitidas</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="totalAmount">0.00 Bs</div>
                <div class="stat-label">Monto Total Facturado</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="lastInvoiceNumber">-</div>
                <div class="stat-label">Último Número de Control</div>
            </div>
        </div>

        <div class="tabs">
            <div class="tab active" id="tabInvoices">Facturas</div>
            <div class="tab" id="tabClients">Clientes</div>
            <div class="tab" id="tabProfile">Mi Perfil</div>
        </div>

        <!-- Tab Facturas -->
        <div class="tab-content" id="contentInvoices">
            <div id="alertContainer"></div>

            <div id="invoiceList">
                <h3>Historial de Facturas</h3>
                <table>
                    <thead>
                        <tr>
                            <th>Número</th>
                            <th>Fecha</th>
                            <th>Cliente</th>
                            <th>Monto</th>
                            <th>IVA</th>
                            <th>IGTF</th>
                            <th>Total</th>
                            <th>Acciones</th>
                        </tr>
                    </thead>
                    <tbody id="invoicesTableBody">
                        <!-- Rows will be populated dynamically -->
                    </tbody>
                </table>
            </div>

            <div id="invoiceForm" class="hidden">
                <div class="form-section">
                    <h3 class="section-title">Información del Cliente</h3>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="clientName">Nombre o Razón Social*</label>
                            <input type="text" id="clientName" required>
                        </div>
                        <div class="form-group">
                            <label for="clientId">Cédula o RIF*</label>
                            <input type="text" id="clientId" placeholder="Ej: V-12345678 o J-12345678-9" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="clientAddress">Dirección*</label>
                            <input type="text" id="clientAddress" required>
                        </div>
                        <div class="form-group">
                            <label for="clientPhone">Teléfono</label>
                            <input type="text" id="clientPhone">
                        </div>
                    </div>
                </div>

                <div class="form-section">
                    <h3 class="section-title">Información de la Factura</h3>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="invoiceDate">Fecha de Emisión*</label>
                            <input type="date" id="invoiceDate" required>
                        </div>
                        <div class="form-group">
                            <label for="paymentMethod">Método de Pago*</label>
                            <select id="paymentMethod" required>
                                <option value="transferencia_bs">Transferencia en Bs.</option>
                                <option value="pago_movil">Pago Móvil</option>
                                <option value="efectivo_bs">Efectivo en Bs.</option>
                                <option value="efectivo_usd">Efectivo en USD</option>
                                <option value="transferencia_usd">Transferencia en USD</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="invoiceNotes">Notas de la Factura</label>
                        <textarea id="invoiceNotes" rows="2"></textarea>
                    </div>
                </div>

                <div class="form-section">
                    <h3 class="section-title">Artículos</h3>
                    <table class="items-table">
                        <thead>
                            <tr>
                                <th width="40%">Descripción</th>
                                <th width="15%">Cantidad</th>
                                <th width="20%">Precio Unitario</th>
                                <th width="20%">Subtotal</th>
                                <th width="5%"></th>
                            </tr>
                        </thead>
                        <tbody id="itemsTableBody">
                            <tr>
                                <td><input type="text" class="item-description" required></td>
                                <td><input type="number" class="item-quantity" min="1" value="1" required></td>
                                <td><input type="number" step="0.01" class="item-price" min="0" value="0.00" required></td>
                                <td class="item-subtotal">0.00</td>
                                <td><button class="btn-secondary remove-item">X</button></td>
                            </tr>
                        </tbody>
                    </table>
                    <button class="btn btn-secondary" id="addItemBtn" style="margin-top: 10px">Agregar Artículo</button>

                    <table class="summary-table">
                        <tr>
                            <td>Subtotal:</td>
                            <td class="text-right" id="summarySubtotal">0.00 Bs.</td>
                        </tr>
                        <tr>
                            <td>IVA (16%):</td>
                            <td class="text-right" id="summaryIva">0.00 Bs.</td>
                        </tr>
                        <tr>
                            <td>IGTF (3%):</td>
                            <td class="text-right" id="summaryIgtf">0.00 Bs.</td>
                        </tr>
                        <tr>
                            <td>Total:</td>
                            <td class="text-right" id="summaryTotal">0.00 Bs.</td>
                        </tr>
                    </table>
                </div>

                <div class="action-buttons">
                    <button class="btn btn-success" id="saveInvoiceBtn">Guardar Factura</button>
                    <button class="btn btn-secondary" id="cancelInvoiceBtn">Cancelar</button>
                </div>
            </div>

            <div id="invoicePreview" class="hidden">
                <div class="preview-header">
                    <div class="preview-logo">FacturaML</div>
                    <div>Fecha: <span id="previewDate"></span></div>
                </div>

                <div class="preview-title">Factura</div>

                <div class="preview-company-info">
                    <h3>Información del Emisor</h3>
                    <div>Nombre: Mi Empresa</div>
                    <div>RIF: J-12345678-9</div>
                    <div>Dirección: Mi Dirección</div>
                    <div>Teléfono: 0212-1234567</div>
                </div>

                <div class="preview-client-info">
                    <h3>Información del Cliente</h3>
                    <div>Nombre: <span id="previewClientName"></span></div>
                    <div>RIF: <span id="previewClientId"></span></div>
                    <div>Dirección: <span id="previewClientAddress"></span></div>
                    <div>Teléfono: <span id="previewClientPhone"></span></div>
                </div>

                <h3>Detalle de la Factura</h3>
                <table class="items-table">
                    <thead>
                        <tr>
                            <th>Descripción</th>
                            <th>Cantidad</th>
                            <th>Precio Unitario</th>
                            <th>Subtotal</th>
                        </tr>
                    </thead>
                    <tbody id="previewItemsTableBody">
                        <!-- Items will be dynamically added here -->
                    </tbody>
                </table>

                <table class="summary-table">
                    <tr>
                        <td>Subtotal:</td>
                        <td id="previewSubtotal"></td>
                    </tr>
                    <tr>
                        <td>IVA (16%):</td>
                        <td id="previewIva"></td>
                    </tr>
                    <tr>
                        <td>IGTF (3%):</td>
                        <td id="previewIgtf"></td>
                    </tr>
                    <tr>
                        <td>Total:</td>
                        <td id="previewTotal"></td>
                    </tr>
                </table>
            </div>
        </div>
    </div>
    
    <div class="modal" id="myModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Título del Modal</h2>
                <span class="close" id="closeModalBtn">&times;</span>
            </div>
            <div class="modal-body" id="modalBodyContent">
                <p>Este es el contenido del modal.</p>
            </div>
        </div>
    </div>
    
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Navbar
            const userDisplayName = document.getElementById('userDisplayName');
            const logoutButton = document.getElementById('logoutButton');

            // Dashboard Stats
            const availableInvoices = document.getElementById('availableInvoices');
            const issuedInvoices = document.getElementById('issuedInvoices');
            const totalAmount = document.getElementById('totalAmount');
            const lastInvoiceNumber = document.getElementById('lastInvoiceNumber');

            // Tabs
            const tabInvoices = document.getElementById('tabInvoices');
            const tabClients = document.getElementById('tabClients');
            const tabProfile = document.getElementById('tabProfile');

            const contentInvoices = document.getElementById('contentInvoices');
            const contentClients = document.getElementById('contentClients');
            const contentProfile = document.getElementById('contentProfile');

            // Invoice Form
            const newInvoiceBtn = document.getElementById('newInvoiceBtn');
            const invoiceForm = document.getElementById('invoiceForm');
            const invoiceList = document.getElementById('invoiceList');
            const addItemBtn = document.getElementById('addItemBtn');
            const itemsTableBody = document.getElementById('itemsTableBody');

            // Invoice Preview
            const invoicePreview = document.getElementById('invoicePreview');

            // Modal
            const modal = document.getElementById('myModal');
            const closeModalBtn = document.getElementById('closeModalBtn');

            // Functions to simulate data loading and tab switching
            function loadUserData() {
                // Simulate loading user data
                setTimeout(() => {
                    userDisplayName.textContent = 'Usuario Ejemplo';
                }, 500);
            }

            function loadDashboardStats() {
                // Simulate loading dashboard stats
                setTimeout(() => {
                    availableInvoices.textContent = '10';
                    issuedInvoices.textContent = '5';
                    totalAmount.textContent = '1500.00 Bs';
                    lastInvoiceNumber.textContent = '000001';
                }, 800);
            }

            function switchTab(tabId) {
                contentInvoices.style.display = 'none';
                contentClients.style.display = 'none';
                contentProfile.style.display = 'none';

                tabInvoices.classList.remove('active');
                tabClients.classList.remove('active');
                tabProfile.classList.remove('active');

                document.getElementById('content' + tabId.substring(3)).style.display = 'block';
                document.getElementById(tabId).classList.add('active');
            }

            // Event listeners
            logoutButton.addEventListener('click', function() {
                alert('Cerrando sesión...');
            });

            tabInvoices.addEventListener('click', function() {
                switchTab('tabInvoices');
            });

            tabClients.addEventListener('click', function() {
                switchTab('tabClients');
            });

            tabProfile.addEventListener('click', function() {
                switchTab('tabProfile');
            });

            newInvoiceBtn.addEventListener('click', function() {
                invoiceForm.classList.remove('hidden');
                invoiceList.classList.add('hidden');
            });

            closeModalBtn.addEventListener('click', function() {
                modal.style.display = 'none';
            });

            // Initial loading
            loadUserData();
            loadDashboardStats();
            switchTab('tabInvoices');
        });
    </script>
</body>
</html>
